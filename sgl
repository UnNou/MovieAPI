
CREATE TABLE genre (  
    genre_id SERIAL PRIMARY KEY,
    genre_name VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE movie (
    movie_id SERIAL PRIMARY KEY, 
    movie_name VARCHAR(255) NOT NULL,
    year INT NOT NULL,
    genre_id INT NOT NULL,
    FOREIGN KEY (genre_id) REFERENCES genre(genre_id) ON DELETE CASCADE
)

CREATE TABLE "user" (
     user_id SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    name VARCHAR(100) NOT NULL,
    year_of_birth INT NOT NULL
)

CREATE TABLE review (
    review_id SERIAL PRIMARY KEY,
    movie_id INT NOT NULL,
    user_id INT NOT NULL,
    stars INT CHECK (stars >= 1 AND stars <= 5),  -- star rating between 1 and 5
    review_text TEXT,  -- text of the review
    FOREIGN KEY (movie_id) REFERENCES movie(movie_id) ON DELETE CASCADE,  -- Links to movie table
    FOREIGN KEY (user_id) REFERENCES "user"(user_id) ON DELETE CASCADE  -- Links...
);

CREATE TABLE user_favorites (
    user_id INT NOT NULL,
    movie_id INT NOT NULL,
    PRIMARY KEY (user_id, movie_id),  -- composite primary key to ensure uniqueness
    FOREIGN KEY (user_id) REFERENCES "user"(user_id) ON DELETE CASCADE,  -- links
    FOREIGN KEY (movie_id) REFERENCES movie(movie_id) ON DELETE CASCADE  -- links
);
